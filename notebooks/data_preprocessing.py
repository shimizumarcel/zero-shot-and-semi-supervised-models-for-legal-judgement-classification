# -*- coding: utf-8 -*-
"""tcc_data.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1V3m8Kpz50w4Afy8GFjbFirILEUuKy8V2
"""

from google.colab import drive
import tensorflow as tf
import json
import pandas as pd
from sklearn.model_selection import train_test_split

drive.mount('/content/drive')

file_path = "/content/drive/My Drive/tcc/data/DocumentosAcordaos.json"

list_info = []
with open(file_path, "r", encoding="utf-8") as file:
    for line in file:
        try:
            data = json.loads(line)
            info = {"integra": "".join(data.get("integratxt", []))}
            list_info.append(info)
        except json.JSONDecodeError:
            continue


df = pd.DataFrame(list_info)
df["label"] = None
df.columns = ["text", "label"]

df.loc[564, "label"] = 1
df.loc[201, "label"] = 1
df.loc[198, "label"] = 1
df.loc[197, "label"] = 1
df.loc[196, "label"] = 1
df.loc[195, "label"] = 1
df.loc[194, "label"] = 1
df.loc[192, "label"] = 1
df.loc[190, "label"] = 1
df.loc[189, "label"] = 1
df.loc[188, "label"] = 1
df.loc[184, "label"] = 1
df.loc[183, "label"] = 1
df.loc[182, "label"] = 1
df.loc[180, "label"] = 1
df.loc[175, "label"] = 1
df.loc[174, "label"] = 1
df.loc[173, "label"] = 1
df.loc[172, "label"] = 1
df.loc[171, "label"] = 1
df.loc[167, "label"] = 1
df.loc[166, "label"] = 1
df.loc[164, "label"] = 1
df.loc[161, "label"] = 1
df.loc[158, "label"] = 1
df.loc[157, "label"] = 1
df.loc[156, "label"] = 1
df.loc[153, "label"] = 1
df.loc[152, "label"] = 1
df.loc[151, "label"] = 1
df.loc[150, "label"] = 1
df.loc[146, "label"] = 1
df.loc[145, "label"] = 1
df.loc[143, "label"] = 1
df.loc[142, "label"] = 1
df.loc[141, "label"] = 1
df.loc[140, "label"] = 1
df.loc[138, "label"] = 1
df.loc[137, "label"] = 1
df.loc[136, "label"] = 1
df.loc[134, "label"] = 1
df.loc[133, "label"] = 1
df.loc[132, "label"] = 1
df.loc[131, "label"] = 1
df.loc[130, "label"] = 1
df.loc[126, "label"] = 1
df.loc[125, "label"] = 1
df.loc[122, "label"] = 1
df.loc[121, "label"] = 1
df.loc[118, "label"] = 1
df.loc[116, "label"] = 1
df.loc[114, "label"] = 1
df.loc[113, "label"] = 1
df.loc[112, "label"] = 1
df.loc[111, "label"] = 1
df.loc[110, "label"] = 1
df.loc[109, "label"] = 1
df.loc[108, "label"] = 1
df.loc[107, "label"] = 1
df.loc[106, "label"] = 1
df.loc[105, "label"] = 1
df.loc[104, "label"] = 1
df.loc[102, "label"] = 1
df.loc[101, "label"] = 1
df.loc[100, "label"] = 1
df.loc[97, "label"] = 1
df.loc[96, "label"] = 1
df.loc[95, "label"] = 1
df.loc[94, "label"] = 1
df.loc[90, "label"] = 1
df.loc[89, "label"] = 1
df.loc[88, "label"] = 1
df.loc[87, "label"] = 1
df.loc[86, "label"] = 1
df.loc[84, "label"] = 1
df.loc[83, "label"] = 1
df.loc[77, "label"] = 1
df.loc[75, "label"] = 1
df.loc[71, "label"] = 1
df.loc[70, "label"] = 1
df.loc[69, "label"] = 1
df.loc[68, "label"] = 1
df.loc[67, "label"] = 1
df.loc[66, "label"] = 1
df.loc[65, "label"] = 1
df.loc[61, "label"] = 1
df.loc[60, "label"] = 1
df.loc[59, "label"] = 1
df.loc[57, "label"] = 1
df.loc[52, "label"] = 1
df.loc[47, "label"] = 1
df.loc[43, "label"] = 1
df.loc[42, "label"] = 1
df.loc[41, "label"] = 1
df.loc[40, "label"] = 1
df.loc[39, "label"] = 1
df.loc[38, "label"] = 1
df.loc[37, "label"] = 1
df.loc[36, "label"] = 1
df.loc[34, "label"] = 1
df.loc[29, "label"] = 1
df.loc[28, "label"] = 1
df.loc[25, "label"] = 1
df.loc[24, "label"] = 1
df.loc[23, "label"] = 1
df.loc[21, "label"] = 1
df.loc[20, "label"] = 1
df.loc[19, "label"] = 1
df.loc[18, "label"] = 1
df.loc[13, "label"] = 1
df.loc[11, "label"] = 1
df.loc[10, "label"] = 1
df.loc[8, "label"] = 1
df.loc[7, "label"] = 1
df.loc[6, "label"] = 1
df.loc[5, "label"] = 1
df.loc[3, "label"] = 1
df.loc[2, "label"] = 1
df.loc[41283, "label"] = 0
df.loc[41277, "label"] = 0
df.loc[41193, "label"] = 0
df.loc[40843, "label"] = 0
df.loc[40737, "label"] = 0
df.loc[40556, "label"] = 0
df.loc[40502, "label"] = 0
df.loc[40311, "label"] = 0
df.loc[35507, "label"] = 0
df.loc[30904, "label"] = 0
df.loc[11928, "label"] = 0
df.loc[4824, "label"] = 0
df.loc[4554, "label"] = 0
df.loc[672, "label"] = 0
df.loc[40304, "label"] = 0
df.loc[40284, "label"] = 0
df.loc[40265, "label"] = 0
df.loc[40240, "label"] = 0
df.loc[40230, "label"] = 0
df.loc[40104, "label"] = 0
df.loc[40096, "label"] = 0
df.loc[40085, "label"] = 0
df.loc[40076, "label"] = 0
df.loc[40059, "label"] = 0
df.loc[40053, "label"] = 0
df.loc[39993, "label"] = 0
df.loc[39975, "label"] = 0
df.loc[39972, "label"] = 0
df.loc[39958, "label"] = 0
df.loc[39747, "label"] = 0
df.loc[39419, "label"] = 0
df.loc[38562, "label"] = 0
df.loc[37648, "label"] = 0
df.loc[37058, "label"] = 0
df.loc[36475, "label"] = 0
df.loc[35815, "label"] = 0
df.loc[35547, "label"] = 0
df.loc[34680, "label"] = 0
df.loc[33869, "label"] = 0
df.loc[33205, "label"] = 0
df.loc[32814, "label"] = 0
df.loc[32784, "label"] = 0
df.loc[32538, "label"] = 0
df.loc[32340, "label"] = 0
df.loc[32044, "label"] = 0
df.loc[31185, "label"] = 0
df.loc[30878, "label"] = 0
df.loc[30367, "label"] = 0
df.loc[29986, "label"] = 0
df.loc[29617, "label"] = 0
df.loc[28227, "label"] = 0
df.loc[26500, "label"] = 0
df.loc[26305, "label"] = 0
df.loc[24835, "label"] = 0
df.loc[24284, "label"] = 0
df.loc[24261, "label"] = 0
df.loc[23695, "label"] = 0
df.loc[23556, "label"] = 0
df.loc[23371, "label"] = 0
df.loc[22112, "label"] = 0
df.loc[22015, "label"] = 0
df.loc[21655, "label"] = 0
df.loc[19870, "label"] = 0
df.loc[19460, "label"] = 0
df.loc[17821, "label"] = 0
df.loc[17405, "label"] = 0
df.loc[16596, "label"] = 0
df.loc[15662, "label"] = 0
df.loc[14061, "label"] = 0
df.loc[11928, "label"] = 0
df.loc[11760, "label"] = 0
df.loc[11550, "label"] = 0
df.loc[11081, "label"] = 0
df.loc[10986, "label"] = 0
df.loc[10194, "label"] = 0
df.loc[9944, "label"] = 0
df.loc[9028, "label"] = 0
df.loc[8827, "label"] = 0
df.loc[8598, "label"] = 0
df.loc[8393, "label"] = 0
df.loc[8040, "label"] = 0
df.loc[7605, "label"] = 0
df.loc[7434, "label"] = 0
df.loc[6781, "label"] = 0
df.loc[6698, "label"] = 0
df.loc[5357, "label"] = 0
df.loc[5257, "label"] = 0
df.loc[5097, "label"] = 0
df.loc[4648, "label"] = 0
df.loc[3932, "label"] = 0
df.loc[3913, "label"] = 0
df.loc[3821, "label"] = 0
df.loc[3661, "label"] = 0
df.loc[3272, "label"] = 0
df.loc[2748, "label"] = 0
df.loc[2414, "label"] = 0
df.loc[2406, "label"] = 0
df.loc[2058, "label"] = 0
df.loc[1155, "label"] = 0
df.loc[1047, "label"] = 0
df.loc[565, "label"] = 0
df.loc[207, "label"] = 0
df.loc[11911, "label"] = 1
df.loc[13219, "label"] = 0
df.loc[505, "label"] = 0
df.loc[3806, "label"] = 1
df.loc[11462, "label"] = 0
df.loc[13636, "label"] = 1
df.loc[30362, "label"] = 0
df.loc[2485, "label"] = 0
df.loc[4938, "label"] = 1
df.loc[3370, "label"] = 1
df.loc[41167, "label"] = 0
df.loc[5273, "label"] = 1
df.loc[3983, "label"] = 1
df.loc[2340, "label"] = 0
df.loc[1524, "label"] = 0
df.loc[1402, "label"] = 1
df.loc[1274, "label"] = 0
df.loc[1217, "label"] = 0
df.loc[991, "label"] = 0
df.loc[756, "label"] = 0
df.loc[744, "label"] = 0
df.loc[5146, "label"] = 1
df.loc[16577, "label"] = 0
df.loc[7646, "label"] = 0
df.loc[1889, "label"] = 0
df.loc[1641, "label"] = 0
df.loc[826, "label"] = 1
df.loc[440, "label"] = 1
df.loc[40625, "label"] = 1
df.loc[2376, "label"] = 1
df.loc[13419, "label"] = 0
df.loc[40527, "label"] = 0
df.loc[27360, "label"] = 0
df.loc[18651, "label"] = 1
df.loc[12390, "label"] = 0
df.loc[7231, "label"] = 1
df.loc[2756, "label"] = 0
df.loc[998, "label"] = 0
df.loc[44, "label"] = 0
df.loc[74, "label"] = 0
df.loc[144, "label"] = 1
df.loc[169, "label"] = 0
df.loc[177, "label"] = 1
df.loc[214, "label"] = 0
df.loc[267, "label"] = 1
df.loc[276, "label"] = 1
df.loc[302, "label"] = 0
df.loc[305, "label"] = 0
df.loc[309, "label"] = 1
df.loc[315, "label"] = 1
df.loc[320, "label"] = 0
df.loc[394, "label"] = 1
df.loc[395, "label"] = 0
df.loc[407, "label"] = 1
df.loc[472, "label"] = 0
df.loc[478, "label"] = 1
df.loc[506, "label"] = 0
df.loc[516, "label"] = 1
df.loc[533, "label"] = 0
df.loc[578, "label"] = 1
df.loc[579, "label"] = 0
df.loc[617, "label"] = 0
df.loc[629, "label"] = 1
df.loc[637, "label"] = 1
df.loc[651, "label"] = 0
df.loc[657, "label"] = 0
df.loc[671, "label"] = 1
df.loc[682, "label"] = 1
df.loc[714, "label"] = 0
df.loc[729, "label"] = 0
df.loc[751, "label"] = 1
df.loc[774, "label"] = 1
df.loc[788, "label"] = 1
df.loc[811, "label"] = 1
df.loc[815, "label"] = 1
df.loc[846, "label"] = 0
df.loc[854, "label"] = 0
df.loc[855, "label"] = 1
df.loc[903, "label"] = 1
df.loc[909, "label"] = 0
df.loc[911, "label"] = 1
df.loc[931, "label"] = 1
df.loc[933, "label"] = 1
df.loc[948, "label"] = 0
df.loc[957, "label"] = 1
df.loc[979, "label"] = 1
df.loc[995, "label"] = 1
df.loc[1051, "label"] = 0
df.loc[1058, "label"] = 1
df.loc[1078, "label"] = 1
df.loc[1087, "label"] = 1
df.loc[1103, "label"] = 1
df.loc[1187, "label"] = 0
df.loc[1200, "label"] = 0
df.loc[1217, "label"] = 0
df.loc[1225, "label"] = 1
df.loc[1232, "label"] = 0
df.loc[1243, "label"] = 1
df.loc[1259, "label"] = 0
df.loc[1304, "label"] = 1
df.loc[1311, "label"] = 0
df.loc[1317, "label"] = 1
df.loc[1327, "label"] = 1
df.loc[1344, "label"] = 0
df.loc[1369, "label"] = 1
df.loc[1377, "label"] = 1
df.loc[1388, "label"] = 1
df.loc[1394, "label"] = 0
df.loc[1405, "label"] = 1
df.loc[1409, "label"] = 0
df.loc[1431, "label"] = 1
df.loc[1480, "label"] = 1
df.loc[1490, "label"] = 1
df.loc[1492, "label"] = 1
df.loc[1499, "label"] = 0
df.loc[1510, "label"] = 0
df.loc[1544, "label"] = 1
df.loc[1579, "label"] = 1
df.loc[1598, "label"] = 0
df.loc[1608, "label"] = 1
df.loc[1620, "label"] = 0
df.loc[1647, "label"] = 1
df.loc[1661, "label"] = 0
df.loc[1664, "label"] = 0
df.loc[1690, "label"] = 0
df.loc[1734, "label"] = 1
df.loc[1774, "label"] = 1
df.loc[1778, "label"] = 0
df.loc[1793, "label"] = 1
df.loc[1842, "label"] = 1
df.loc[1884, "label"] = 1
df.loc[1903, "label"] = 1
df.loc[1944, "label"] = 1
df.loc[2016, "label"] = 1
df.loc[2019, "label"] = 1
df.loc[2024, "label"] = 0
df.loc[2040, "label"] = 0
df.loc[2051, "label"] = 1
df.loc[2186, "label"] = 0
df.loc[2223, "label"] = 0
df.loc[2244, "label"] = 0
df.loc[2276, "label"] = 1
df.loc[2449, "label"] = 0
df.loc[2529, "label"] = 0
df.loc[2646, "label"] = 0
df.loc[2706, "label"] = 0
df.loc[2722, "label"] = 0
df.loc[2749, "label"] = 0
df.loc[2765, "label"] = 1
df.loc[2788, "label"] = 1
df.loc[2926, "label"] = 0
df.loc[2953, "label"] = 0
df.loc[3040, "label"] = 0
df.loc[294, "label"] = 1
df.loc[2004, "label"] = 1
df.loc[2568, "label"] = 0
df.loc[2574, "label"] = 1
df.loc[2764, "label"] = 0
df.loc[2822, "label"] = 1
df.loc[3137, "label"] = 0
df.loc[3326, "label"] = 0
df.loc[3625, "label"] = 0
df.loc[4395, "label"] = 1
df.loc[4497, "label"] = 0
df.loc[5160, "label"] = 0
df.loc[5533, "label"] = 0
df.loc[6158, "label"] = 0
df.loc[6297, "label"] = 1
df.loc[5543, "label"] = 0
df.loc[6778, "label"] = 1
df.loc[1354, "label"] = 0

df["label"].value_counts()

df_sup = df[df['label'].notna()].copy()
df_sup["label"] = df_sup["label"].astype(int)
df_sup = df_sup.reset_index(drop=True)
df_unsup = df.loc[df['label'].isna()].reset_index(drop=True)

df_train, df_test = train_test_split(df_sup, test_size=0.2, random_state=42)

# Salva os arquivos no formato TSV
df_train.to_csv('/content/drive/My Drive/tcc/data/train.csv', index=False, encoding="utf-8")
df_test.to_csv('/content/drive/My Drive/tcc/data/test.csv', index=False, encoding="utf-8")
df_unsup.to_csv('/content/drive/My Drive/tcc/data/unsup.csv', index=False, encoding="utf-8")